/*	:SYNRSOU:03-PRIM:040-GLOB  $TITLE  Define Global Information Variables	*/

/*
Modified:
1999/11/17 - CJ  - Added CLICK.DISP.MODE == 2 for frames-per-beat
1999/10/31 - TY  - Added CFIT.MAP.PTR for use by Conductor Tools curve fitting routines
1999/09/21 - CJ  - Added ext.clock.mode == 6 for OMS Midi Sync
1999/03/04 - TY  - Split CLICK.TRACK.MODE into CLICK.TRACK.MODE and CLICK.DISP.MODE
1998/06/24 - TY  - Split CLICK.TRACK.MODE into CLICK.TRACK.MODE and CLICKON
1998/06/22 - TY  - Added comments pertaining to new Transpose Lock (blinking) feature.
1993/08/16 - PF  - Added disp.mutli.errs
1991/03/22 - cj  - Changed seq.spl.time to fix Lee Kopp FM retrigger clicks
1991/04/13 - KJC - Added external record trigger and d34gpi variables
1991/02/01 - PF  - Moved "Divisions" to Synclits
1990/10/10 - PF  - Add Loop.Seq.Time.Of.Next.Click
1990/10/10 - PF  - Expand TRACK.FORMAT to allow for beats only display mode
1990/07/16 - PF  - Added REAL.TIME.OF.MIDI.LIMIT
						 and REAL.TIME.OF.RECEIVED.LIMIT
1990/07/10 - PF  - Added meter map dcls
1990/03/21 - PF  - Compressed CLAV.PTR to 43 sectors
1990/03/09 - PF  - Extended CLAV.PTR to 128 sectors
1989/09/23 - CJ  - Added tempo, click, meter map ptrs
1989/08/24 - PF  - Add MAX.MIDINET.CHAN
1989/08/24 - PF  - Add MIDInet sync to ext.clock.mode (ext.clock.mode = 5)
1989/06/20 - MWH - Add "play to" time for the sequencer
1989/06/07 - TSS - Added PMAP.PTR for new Kbd mapping stuff
1989/06/05 - TSS - Added some documentation of how TTMAP.PTR & VMAP.PTR info is layed out
1989/01/16 - MWH - Add Auto Punch feature
1988/10/03 - cj  - added loop.trigger.click, loop.last.click
1988/09/21 - TSS - Added dcl of BSTAT.PTR
1988/04/15 - PF  - Extended CLAV.PTR to 18 sectors
1988/03/14 - CJ  - ADDED NEW.CUE.TRACK.SETTINGS
1988/02/04 - TSS - ADDED XMEM PTR DCL TO NEW POLY FREQ LOOKUP TABLE
1987/06/25 - MWH - Split FRP.PTR into FP0-FP3.PTR for expanded poly
1987/06/22 - MWH - Move multi.syn2 to external memory at MFM.PTR
1987/06/18 - MWH - Update for expanded poly; multi.poly to ext memory
1986/11/13 - TS  - ADDED CHAIN & CHAIN.REPETITIONS DCLS
1986/10/30 - TS  - ADDED EDIT.LEN.MSB, EDIT.LEN.LSB VARS
1986/10/07 - KJO - updated for -7 catalog structure
1986/10/15 - TS  - ADDED LAST.LOOP.PARM,LOOP.START.MSB/LSB,LOOP.END.MSB/LSB
1986/08/25 - TS  - CHANGES TO OVERWRITE DCLS FOR THD.ACTIVE.MIDI.RTES CODE
1986/08/06 - TSS - ADDED RTE.OVERWRITE.BITS DCL
1986/07/25 - BSW - deleted references to mrec.ptr and msum.ptr
1986/06/19 - CJ  - ADDED SCSIBITS
1986/06/09 - BSW - defined polyadc and adconfig for 100 kHz sampling
1986/05/22 - eeg - added mrec.ptr and msum.ptr for multi-track info
1986/05/15 - "official" creation of release-M modules
*/


DCL RANDOM#			FIXED PUBLIC;	/*	RANDOM NUMBER SEED	*/

/*	INTERRUPT STORAGE:	*/
/**** THE FOLLOWING 7 VARIABLES NEED TO BE IN THIS ORDER!!! (SEE 144-TIM3) ****/
DCL (INTCHA)		FIXED PUBLIC;	/*	PRESERVE CHAN# DURING INTRPT	*/
DCL (INTFUN)		FIXED PUBLIC;	/*	AND FUNCTION CODE					*/

DCL (SAVE.R13)		FIXED PUBLIC;
DCL (SAVE.MAM)		FIXED PUBLIC;
DCL (SAVE.MAL)		FIXED PUBLIC;

DCL (PSCHAN)		FIXED PUBLIC;
DCL (PSFUN)			FIXED PUBLIC;

/*	GLOBAL VARIABLES FOR TIMBRE AND SEQUENCE RECALL:	*/

DCL PLAY.TIME.MSB						FIXED PUBLIC;	/*	COUNTS 32 BIT # OF MILLISECONDS	*/
DCL PLAY.TIME.LSB						FIXED PUBLIC;	/*	NOTE: SCRIPT 0.000 = ZERO.TIME	*/
DCL PLAY.TIME.ACU						FIXED PUBLIC;	/*	TIME ACCUMULATOR FOR SPEED			*/
DCL NEXT.CLICK							FIXED PUBLIC;	/*	LSB OF NEXT CLICK						*/
DCL NEXT.SEQ.EVENT					FIXED PUBLIC;	/*	LSB OF NEXT SEQ EVENT				*/
DCL BEAT.NUMBER						FIXED PUBLIC;	/*	BEAT # OF LAST CLICK					*/

DCL PRIOR.CLICK.MSB					FIXED PUBLIC;	/*	SEQUENCE TIME OF PRIOR CLCIK		*/
DCL PRIOR.CLICK.LSB					FIXED PUBLIC;
DCL NEXT.CLICK.MSB					FIXED PUBLIC;	/*	SEQUENCE TIME OF NEXT CLICK		*/
DCL NEXT.CLICK.LSB					FIXED PUBLIC;
DCL PRIOR.BEAT.MSB					FIXED PUBLIC;	/*	SEQUENCE TIME OF PRIOR BEAT		*/
DCL PRIOR.BEAT.LSB					FIXED PUBLIC;
DCL NEXT.BEAT.MSB						FIXED PUBLIC;	/*	SEQUENCE TIME OF NEXT BEAT			*/
DCL NEXT.BEAT.LSB						FIXED PUBLIC;
DCL REAL.TIME.OF.PRIOR.CLICK.MSB	FIXED PUBLIC;	/*	REAL TIME OF PRIOR CLICK			*/
DCL REAL.TIME.OF.PRIOR.CLICK.LSB	FIXED PUBLIC;
DCL REAL.TIME.OF.NEXT.CLICK.MSB	FIXED PUBLIC;	/*	REAL TIME OF NEXT CLICK				*/
DCL REAL.TIME.OF.NEXT.CLICK.LSB	FIXED PUBLIC;
DCL ACTUALLY.EMIT.CLICK				FIXED PUBLIC;	/*	TELLS INTERRUPT CODE OK TO CLICK	*/
DCL REAL.TIME.OF.PRIOR.BEAT.MSB	FIXED PUBLIC;	/*	REAL TIME OF PRIOR BEAT				*/
DCL REAL.TIME.OF.PRIOR.BEAT.LSB	FIXED PUBLIC;
DCL REAL.TIME.OF.NEXT.BEAT.MSB	FIXED PUBLIC;	/*	REAL TIME OF NEXT BEAT				*/
DCL REAL.TIME.OF.NEXT.BEAT.LSB	FIXED PUBLIC;
DCL COMPUTE.NEXT.CLICK				FIXED PUBLIC;	/*	CAUSES REAL.TIME.OF.NEXT.CLICK TO BE RECOMPUTED	*/

DCL NUM.MIDI.CLOCKS					FIXED PUBLIC;	/*	NUMBER OF CLOCKS EMITTED IN INTERRUPT SINCE LAST MAIN LOOP	*/
DCL REAL.MIDI.CLOCK.RATE			FIXED PUBLIC;	/*	CURRENT RATE OF MIDI CLOCK IN REAL TIME DURATION	*/
DCL NEXT.MIDI.CLOCK.RATE			FIXED PUBLIC;	/*	RATE OF MIDI CLOCKS AT NEXT TEMPO CHANGE	*/
DCL REAL.TIME.OF.NEXT.TEMPO.MSB	FIXED PUBLIC;	/*	TIME OF NEXT TEMPO CHANGE	*/
DCL REAL.TIME.OF.NEXT.TEMPO.LSB	FIXED PUBLIC;
DCL DISABLE.MIDI.CLOCKS				FIXED PUBLIC;	/*	FLAG TO PREVENT INTERRUPT CODE FROM INTERFERRING WITH MAIN LOOP CALCULATION	*/

DCL (BOUNCE)							FIXED PUBLIC;	/*	TRUE FOR BOUNCE OPERATION ACTIVE		*/
DCL (CHAIN)								FIXED PUBLIC;	/*	TRUE FOR CHAIN OPERATIONS				*/
DCL (RECD.JUST)						FIXED PUBLIC;	/*	TRUE IF JUSTIFIED RECORDING ACTIVE	*/
DCL (RECALL.STATE)					FIXED PUBLIC;	/*	INDICATE ACTION TO TAKE ON TIMBRE RECALL BUTTON PRESSED	*/
DCL (TIMB.DEST)						FIXED PUBLIC;	/*	INDICATES STATE OF SMT/SKT/SPLT		*/
DCL (OUR.TIMBRE)						FIXED PUBLIC;	/*	CURRENT TIMBRE TO DISPLAY	*/
DCL (OUR.BANK)							FIXED PUBLIC;	/*	CURRENT BANK	TO DISPLAY	*/
DCL (OUR.SEQ)                    FIXED PUBLIC;	/* CURRENT SEQ    TO DISPLAY, -1 means none */
DCL (BUTMODE)							FIXED PUBLIC;	/*	-1=NONE, 0=ENTRY MODE, 1=BANK MODE, 2=SEQUENCE MODE	*/
DCL (INFO.MODE)						FIXED PUBLIC;	/*	0=NORMAL NO-INFO MODE, 1=INFO MODE		*/
DCL (SMT,SKT,SPLT,TPAN,TGRP)		FIXED PUBLIC;	/*	FOR SMT, SKT, SPLIT, TPAN, TRACK GROUP	*/


/*	VARIABLES FOR ALLOCATING CHANNELS & WAVE MEMORIES:	*/

DCL (LSYN1.START,LSYN1.END)		FIXED PUBLIC;	/*	CHANNELS IN LOGICAL SYNTHESIZER 1	*/
DCL (LSYN2.START,LSYN2.END)		FIXED PUBLIC;	/*	CHANNELS IN LOGICAL SYNTHESIZER 2	*/


/*	SECTOR POINTERS ALLOCATED DURING INITIALIZATION: (TOP DOWN)	*/

DCL (STB.PTR)			FIXED PUBLIC;	/*	( 1) EXTERNAL SECTOR OF SINE TABLE			*/
DCL (FRE.PTR)			FIXED PUBLIC;	/*	( 8) FREQUENCY TABLE								*/
DCL (LTB.PTR)			FIXED PUBLIC;	/*	( 4) LOG TABLE										*/
DCL (POLY.FRE.PTR)	FIXED PUBLIC;	/*	(16) NEW POLY SAMPLING FREQUENCY TABLE		*/

DCL (NUL.PTR)			FIXED PUBLIC;	/*	( 1) XMEM SEC # OF NULL TIMBRE				*/
DCL (KBD.PRE)			FIXED PUBLIC;	/*	(47) PRECOMPUTED KEYBARD PARTIAL BLOCKS	*/
DCL (CLAV.PTR)			FIXED PUBLIC;	/*	(xx) EXT MEM SECTORS FOR KBD AND MIDI KEY STATE INFO (INDEXED BY CHANNEL AND KEY #)	*/

DCL (TTMAP.PTR)		FIXED PUBLIC;	/*	( 1) XMEM PTR - SYNCLAVIER TRANSIT TIME TO VOLUME MAPPING (TTIME = 0 TO 255)			*/
/*	AT TTMAP.PTR+0: SYNCLAVIER TRANSIT TIME (0-255) TO RTE VALUE (0-225) MAPPING	*/

DCL (VMAP.PTR)			FIXED PUBLIC;	/*	( 2) EXT MEM PTR ONLY  - MIDI VELOCITY TO VOLUME MAPPING	*/
/*	AT VMAP.PTR+0: MIDI VELOCITY (0-127) TO VOLUME (0-225) MAPPING			*/
/*	AT VMAP.PTR+1: SYNCLAVIER RTE VALUE (0-225) TO MIDI (0-127) MAPPING	*/

DCL (PMAP.PTR)			FIXED PUBLIC;	/*	( 3) EXT MEM PTR ONLY - PRESSURE MAPPING/CALIBRATION		*/
/*	AT PMAP.PTR+0: PRESSURE CALIBRATION DATA - THIS IS UNIQUE TO EACH KBD.	*/
/*						MANUFACTURING CREATES THIS INFO WHEN THE KBD IS BUILT		*/
/*						THE DATA IS THE RAW HARDWARE READING OBTAINED WHEN A		*/
/*						STANDARD 20 OZ. WEIGHT IS PLACED ON EACH KEY.  HENCE,		*/
/*						YOU GET ONE READING PER KEY.  THIS VALUE IS USED TO		*/
/*						SCALE THE PRESSURE MAP.  THE READING OBTAINED WILL			*/
/*						REPRESENT THE 90% POINT IN THE PRESSURE MAP.					*/
/*	AT PMAP.PTR+1: SYNCLAVIER BASELINE PRESSURE READINGS (ONE PER KEY)		*/
/*						THIS DATA IS RE-CREATED WHENEVER THE RESTORE.POWER			*/
/*						ROUTINE IS CALLED. IT MEASURES THE RAW HARDWARE READING	*/
/*						OBTAINED WITH NO PRESSURE APPLIED TO THE KEY. SOFTWARE	*/
/*						ASSUMES THE KEYS WILL NOT BE HELD DOWN DURING THE			*/
/*						PROCEDURE. YOU GET ONE READING PER KEY.  THIS INFO IS		*/
/*						SUBTRACTED FROM EACH PRESSURE READING TO GET AN OFFSET	*/
/*						FROM THE PRESSURE BASELINE.  THIS LEADS TO A MORE			*/
/*						CONSISTENT AND ROBUST PRESSURE SUBSYSTEM.						*/
/*	AT PMAP.PTR+2: PRESSURE (0-255?) TO RTE VALUE (0-225) MAPPING				*/

DCL (LOAD.PTR)			FIXED PUBLIC;	/*	( 3) LOADER FROM UPPER MEMORY					*/
DCL (PBN.PTR)			FIXED PUBLIC;	/*	( 2) PHYSICAL BUTTON NUMBER LOOKUP TABLE	*/
DCL (ORK.PTR)			FIXED PUBLIC;	/*	( 2) PHYSICAL BUTTON NUMBER LOOKUP TABLE	*/
DCL (TBUT.PTR)			FIXED PUBLIC;	/*	( 1) LOOK UP TABLE FOR TRACK BUTTONS		*/
DCL (BSTAT.PTR)		FIXED PUBLIC;	/*	( 1) LOOK UP TABLE FOR CLAVIER BUTTON PANEL STATUS	*/
DCL (USE.PTR)			FIXED PUBLIC;	/*	( 1) ACTIVE TIMBRE USAGE COUNTERS			*/
DCL (MPOLY.PTR)		FIXED PUBLIC;	/*	( 1) MULTI-CHANNEL TO POLY VOICE MAPPING TABLE	*/
DCL (MFM.PTR)			FIXED PUBLIC;	/*	( 1) MULTI-CHANNEL TO FM VOICE MAPPING TABLE		*/

DCL (NEW.KBD.PRE)		FIXED PUBLIC;	/*	SET TO 1 TO RECOMPUTE KEYBOARD INFO			*/

/*	$PAGE - POINTERS FOR POLY/MONO MEMORY ALLOCATION, INTERNAL MEMORY	*/

/*	SECTOR POINTERS FOR MONO & POLY ALLOCATION:	*/

DCL (MSFIRST,MSLAST,MSMAX,MSFREE)	FIXED PUBLIC;


/*	INTERNAL MEMORY ALLOCATION:	*/

DCL (FR1.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE LIST #1	*/
DCL (FR2.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE LIST #2	*/
DCL (FRM.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE CHANNEL LIST FOR MONO SAMPLING			*/
DCL (FP0.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE CHANNEL LIST FOR POLY SAMPLING BIN 0	*/
DCL (FP1.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE CHANNEL LIST FOR POLY SAMPLING BIN 1	*/
DCL (FP2.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE CHANNEL LIST FOR POLY SAMPLING BIN 2	*/
DCL (FP3.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - FREE CHANNEL LIST FOR POLY SAMPLING BIN 3	*/
DCL (STR.PTR)			FIXED PUBLIC;	/*	CORE POINTER ONLY - NOTE & PARTIAL BLOCK STORAGE	*/

DCL (NUM.NBLKS,NUM.PBLKS)	FIXED PUBLIC;	/*	NUMBER OF NOTE & PARTIAL BLOCKS	*/


/*	DATA ARRAYS	*/

DCL WESTERN.SCALE		DATA	PUBLIC (0,85,171,256,341,427,512,597,683,768,853,939);
DCL NULL.TIMBRE		DATA	PUBLIC (-2,-2,-2,-2,0,0,0,0,0,0,1000,"172");
DCL DENVLIM				DATA	PUBLIC (0,22,32,45,64,90,128,181,256);		/*	3 DB POWER PER STEP	*/
DCL DEC.ADJ.TAB		DATA	PUBLIC (16,14,12,10,8,7,6,5,4,3,2,1);		/*	FOR DECAY ADJUST		*/
DCL DUR.MUL.DATA		DATA	PUBLIC (1,4,16,64);								/*	DURATION MULTIPLIERS FOR NOTE DURATIONS	*/
DCL POWERS.MSB			DATA	PUBLIC (   15,    1,    0,   0,  0, 0,0);	/*	FOR 1,000,000 # OF NOTES LEFT	*/
DCL POWERS.LSB			DATA	PUBLIC (16960,34464,10000,1000,100,10,1);

/*	MULTI OUTPUT VARIABLES	*/

DCL MULTI.THERE		FIXED PUBLIC;	/*	SET TRUE IF MULTI HARDWARE ATTACHED	*/
DCL MULTI.MAX			FIXED PUBLIC;	/*	# OF OUTPUT CHANNELS						*/
DCL MULTI.ERRS			FIXED PUBLIC;	/*	INPUT VOICES WITH ERRORS				*/
DCL DISP.MULTI.ERRS	FIXED PUBLIC;	/*	IF TRUE DISPLAY MULTICHANNEL ERRORS	*/

/*	BASIC MIDI INFO:	*/

DCL MIDI.THERE			FIXED PUBLIC;	/*	NON-ZERO IF ANY MIDI SUBSYSTEMS FOUND (BITS 0-7 SET FOR EACH SUBSYS FOUND)	*/
DCL MAX.MIDI.CHAN		FIXED PUBLIC;	/*	MAX OUTPUT CHANNEL NUMBER FOUND	*/
DCL MAX.MIDINET.CHAN	FIXED PUBLIC;	/*	MAX OUTPUT NUMBER IN MIDINET CONFIGURATION	*/

/*	$PAGE - SEQUENCER VARIABLES	*/


/*	SEQUENCER.CONTROL.REG IS A SHIFT REGISTER WHICH CAN BE USED TO BUFFER
UP TO 4 SEQUENCER CONTROL COMMANDS (START,CONTINUE,STOP) WHICH WILL BE
ACTED UPON IN THE MAIN LOOP (300-MAIN).  EACH COMMAND USES 4 BITS OF THE
VARIABLE.  NEW COMMANDS ARE SHIFTED IN FROM THE RIGHT AND TAKEN OUT FROM
THE RIGHT.	*/

DCL SEQUENCER.CONTROL.REG	FIXED PUBLIC;	/*	SET TO TURN ON/OFF SEQUENCER FROM MAIN LOOP	*/
											/*	0	=  DO NOTHING						*/
											/*	1	=  ACT LIKE START BUTTON		*/
											/*	2	=  ACT LIKE CONTINUE BUTTON	*/
											/*	3	=  ACT LIKE STOP BUTTON			*/
											/*	4	=  REPOSITION TO START OF SEQ	*/

/*	TIME BASE:	*/

DCL KBD.MILLISECONDS			FIXED PUBLIC;	/*	TIME BASE FOR KEYBOARD DELAYS	*/


/*	$PAGE - VARIABLES FOR WINDOW DISPLAY	*/

/*	NOTE - FOR OLD KEYBOARD, EVERYTYHING IS DISPLAYED IN THE	*/
/*	UPPER WINDOW, SINCE THE LOWER WINDOW DOES NOT EXIST.		*/
/*	LOWER.DISP IS ALWAYS ZERO FOR OLD KEYBOARD SOFTWARE.		*/

DCL UPPER.DISP		FIXED PUBLIC;	/*	DISPLAYED IN UPPER WINDOW	*/	/*	0 = NOTHING RECOGNIZED	*/
DCL LOWER.DISP		FIXED PUBLIC;	/*	DISPLAYED IN LOWER WINDOW	*/	/*	POSITIVE = THAT PARAMETER (FOR RESETTING ON DOUBLE BOUNCE)	*/

DCL TRACK.FORMAT	FIXED PUBLIC;	/*	0: BEATS									*/
											/*	1: MEASURES/BEATS						*/
											/*	2: SECONDS								*/
											/*	3: SMPTE  -  FOR TRACK DISPLAY	*/

DCL WIMAGE (31)	FIXED PUBLIC;	/*	WINDOW IMAGE - ASCII EQUIV OF WINDOW DISPLAY	*/

DCL NEW.UPPER		FIXED PUBLIC;	/*	SET WHEN WINDOW IMAGE CHANGES		*/
DCL NEW.LOWER		FIXED PUBLIC;	/*	UPPER AND LOWER HALVES				*/

#if (inc.voice.output)
	DCL SPEAK.IT	FIXED PUBLIC;	/*	SET TRUE TO ACTIVATE D42			*/
	DCL SPEAK.TIME	FIXED PUBLIC;	/*	TIME TO RE-ENABLE						*/
#endif

/*	$SUBTITLE:  GLOBAL PARAMETERS	*/

/*	CERTAIN KNOB-CONTROLLED PARAMETERS ARE NOT STORED AS PART OF A TIMBRE
.	DEFINITION (FOR EXAMPLE: OVERALL TUNING).  THESE PARAMETERS ARE
.	INITIALIZED EVERY TIME THE SYSTEM IS LOADED.	*/

/*	DEFINITIONS AND STORAGE AREA FOR OVERALL PARAMETERS:	*/


DCL GPDT(NUM.GLOB.PARS-1)	FIXED PUBLIC;	/*	GLOBAL PARAMETER DATA	*/

DCL MARK.BUTTON.DISABLED	FIXED PUBLIC;	/*	WHETHER OR NOT MARK.BUTTON IS ACTIVE	*/
DCL XPOS.TRIGGER.DISABLED	FIXED PUBLIC;

DCL LAST.LOOP.PARM			FIXED PUBLIC;	/*	LAST SELECTED LOOP PARM	*/
DCL LOOP.START.MSB			FIXED PUBLIC;	/*	HOLDS LOOP START TIME PARM	*/
DCL LOOP.START.LSB			FIXED PUBLIC;
DCL LOOP.END.MSB				FIXED PUBLIC;	/*	HOLDS LOOP END TIME PARM	*/
DCL LOOP.END.LSB				FIXED PUBLIC;
DCL EDIT.LEN.MSB				FIXED PUBLIC;	/*	HOLDS INSERT/DELETE LENGTH	*/
DCL EDIT.LEN.LSB				FIXED PUBLIC;
DCL CHAIN.REPETITIONS		FIXED PUBLIC;	/*	HOW MANY COPIES OF TRK TO CHAIN	*/

DCL V.S.MUL						FIXED PUBLIC;	/*	COMPUTED FROM V.S.MIN (SENS)	*/

DCL LOGTBASE					FIXED PUBLIC;	/*	HOLDS LOG OF OVERALL TUNING BASE AT ALL TIMES	*/

DCL RTE.OVERWRITE.BITS		FIXED PUBLIC;	/*	HOLDS EXPRESSION OVERDUB ENABLE BITS	*/
DCL OVERWRITE.LOOKUP			DATA	PUBLIC (VKPE1.L,VKPE2.L,VKMOD.L,VKBTH.L,PTUN.L,VKRIB.L,VKPRE.L,VKVEL.L);	/*	LPNS FOR DEFINED OVERWRITE EXPRESSION LIGHTS	*/


/*	VARIABLES FOR SOUND FILE PROCESSING:	*/

DCL NEWFNAME	(4)	FIXED PUBLIC;

DCL MONO.STATE			FIXED PUBLIC;

DCL MONO.ELIM			FIXED PUBLIC;
DCL MONO.INC			FIXED PUBLIC;
DCL MONO.DIVISOR		FIXED PUBLIC;
DCL MONO.ENV.TIME		FIXED PUBLIC;

DCL MONO.CHAN			FIXED PUBLIC;


/*	GENERAL POINTER INTO A TIMBRE AREA	*/
DCL PTPTR	FIXED PUBLIC;

/*	SEQUENCER VARIABLES FROM 130-SDEF	*/
/*	SECTOR POINTERS FOR REAL TIME ALLOCATION: (BOTTOM UP)	*/

DCL (BAS.PTR,BAS.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM OF BASE SECTOR			*/
DCL (PAR.PTR,PAR.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM OF TIMBRE INFO			*/
DCL (NAH.PTR,NAH.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM OF NOTE AREA HEADER	*/
DCL (BNK.PTR,BNK.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM OF TIMBRE BANK			*/
DCL (INF.PTR,INF.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM FOR SEQ INFO				*/
DCL (TIM.PTR,TIM.LEN)	FIXED PUBLIC;	/*	SEC # IN XMEM FOR TIM/PAR INFO		*/

DCL (NAH.FREE)				FIXED PUBLIC;	/*	LINKED LIST OF FREE BLOCKS IN NAH	*/
DCL (NAH.#FREE)			FIXED PUBLIC;	/*	NUMBER THEREIN								*/

DCL (TIM.FREE)				FIXED PUBLIC;	/*	LINKED LIST OF FREE BLOCKS IN TIM	*/
DCL (TIM.#FREE)			FIXED PUBLIC;	/*	NUMBER THEREIN								*/

DCL (NEXT.EVENT.QUEUE)	FIXED PUBLIC;
DCL (NEXT.EVENT.MSB)		FIXED PUBLIC;
DCL (NEXT.EVENT.LSB)		FIXED PUBLIC;


/*	POINTERS TO OTHER DATA STRUCTURES IN SEQUENCE: (TEMPO MAP, METER MAP).
	NUMBER OF VARIABLS MUST MATCH '#.OF.MAP.PTRS'.
	THESE HOLD ABSOLUTE POINTERS TO START OF LINKED BLOCKS FOR EACH DATA
	STRUCTURE.
	NOTE: MUST DECLARE IN ORDER!!!!	*/

DCL TEMPO.MAP.PTR	FIXED PUBLIC;
DCL METER.MAP.PTR	FIXED PUBLIC;
DCL CFIT.MAP.PTR	FIXED PUBLIC;

/*	TO PROVIDE FOR SPEEDY ACCESS TO INFORMATION FOR A PARTICULAR TRACK,
	A LOOK UP TABLE IS CONSTRUCTED THAT CONTAINS THE ABSOLUTE SECTOR
	NUMBER OF THE TRACK HEADER SECTOR FOR EACH TRACK.  THIS LOOK
	UP TABLE IS STORED IN EXTERNAL MEMORY AND IS POINTED TO BY TRK.HEAD.

	TWO SPECIAL SECTORS ARE ALLOCATED FOR THE KEYBOARD AND THE SPLIT
	KEYBOARD.	*/

DCL TRK.HEAD	FIXED PUBLIC;	/*	POINTER TO LOOK UP TABLE IN XMEM	*/


/*	TO PROVIDE SPEEDY ACCESS TO THE DATA FOR EACH TIMBRE, A LOOK UP
	TABLE IS CONSTRUCTED THAT CONTAINS POINTER TO THE SECTOR # FOR
	EACH TIMBRE.  THIS LOOK UP TABLE IS STORED IN EXTERNAL MEMORY
	AND IS POINTED TO BY TIM.HEAD:	*/

DCL TIM.HEAD	FIXED PUBLIC;	/*	SECTOR NUMBER OF EXTERNAL MEMORY WITH TIMBRE/PARTIAL INFO	*/

/*	WHEN A SEQUENCE IS READ IN FROM DISK, THE POINTERS IN THE	*/
/*	TRACK HEADER SECTOR MUST BE INITIALIZED.							*/

DCL NUM.OF.SOLOED.TRACKS	FIXED PUBLIC;

DCL (CPLIST0)	FIXED PUBLIC;	/*	HEAD OF CHANNEL PRESSURE LIST	*/
DCL (ARLIST0)	FIXED PUBLIC;	/*	HEAD OF RIBBIN  FILTER	 LIST	*/
DCL (UPLIST0)	FIXED PUBLIC;	/*	HEAD OF UPDATE  LIST		 LIST	*/

/*	SEQUENCER CONTROL VARIABLES:	*/

DCL ADVANCED.PLAY.TIME.MSB	FIXED PUBLIC;	/*	SAMPLED ONCE PER MAIN LOOP	*/
DCL ADVANCED.PLAY.TIME.LSB	FIXED PUBLIC;	/*	NOTE: THESE VARIABLES		*/
DCL ADVANCED.NEXT.CLICK		FIXED PUBLIC;	/*	ARE ADVANCED BY 'PRESCAN'	*/
DCL ADVANCED.BEAT.NUMBER	FIXED PUBLIC;

DCL ADVANCED.SEQ.TIME.MSB	FIXED PUBLIC;	/*	VERSION OF ADVANCED PLAY	*/
DCL ADVANCED.SEQ.TIME.LSB	FIXED PUBLIC;	/*	MAPPED TO SEQUENCER UNITS	*/

DCL LOOP.PLAY.TIME.MSB		FIXED PUBLIC;	/*	TIME OF OVERALL LOOP START	*/
DCL LOOP.PLAY.TIME.LSB		FIXED PUBLIC;
DCL LOOP.PLAY.TIME.ACU		FIXED PUBLIC;
DCL LOOP.NEXT.CLICK			FIXED PUBLIC;
DCL LOOP.BEAT.NUMBER			FIXED PUBLIC;
DCL LOOP.TRIGGER.CLICK		FIXED PUBLIC;
DCL LOOP.LAST.CLICK			FIXED PUBLIC;
DCL LOOP.REAL.TIME.OF.NEXT.CLICK.MSB	FIXED PUBLIC;
DCL LOOP.REAL.TIME.OF.NEXT.CLICK.LSB	FIXED PUBLIC;

DCL LOOP.SEQ.TIME.MSB						FIXED PUBLIC;	/*	LOOP START POINT MAPPED	*/
DCL LOOP.SEQ.TIME.LSB						FIXED PUBLIC;	/*	TO SEQUENCER UNITS		*/
DCL LOOP.SEQ.TIME.OF.NEXT.CLICK.MSB		FIXED PUBLIC;
DCL LOOP.SEQ.TIME.OF.NEXT.CLICK.LSB		FIXED PUBLIC;

DCL PRESCAN			FIXED PUBLIC;	/*	PRESCAN SEQUENCER BY 8 TICKS FOR BETTER TIMING	*/

DCL SEQ.MONO3		FIXED PUBLIC;	/*	MONO SPLICE SAMPLING TIME FOR SEQUENCER NOTES	*/

DCL REPSCAN1		FIXED PUBLIC;	/*	PRESCAN TIME FOR REPEAT/ARPEGG		*/

DCL SEQ.SPL.TIM	FIXED PUBLIC;	/*	SPLICE TIME FOR POLY NOTES				*/
DCL SEQ.FM1			FIXED PUBLIC;	/*	FIRST SPLICE FOR FM NOTES				*/
DCL SEQ.FM2			FIXED PUBLIC;	/*	SECOND SPLICE FOR FM NOTES				*/


DCL (CONT,ERAS)							FIXED PUBLIC;	/*	SEQUENCER STATE VARIABLES							*/
DCL (MOVE.LIMIT.MSB,MOVE.LIMIT.LSB)	FIXED PUBLIC;	/*	ABS SEQ TIME LIMIT TO FF/REWIND TO				*/
DCL (MOVE.SPEED)							FIXED PUBLIC;	/*	>0 FOR F.F, <0 FOR REWINDING						*/
DCL (ABORT.SEQ.NOTES)					FIXED PUBLIC;	/*	CAUSES TERMINATION OF ACTIVE NOTES ON 'STOP'	*/
DCL (ABRT.RECORDING)						FIXED PUBLIC;	/*	SET TRUE IF SHOULD ABORT RECORDING NOTES		*/
DCL (RECD.TRK)								FIXED PUBLIC;	/*	HOLDS TRACK # (2-255?)								*/
DCL (ERASE.STYLE)							FIXED PUBLIC;	/*	HOLDS STYLE OF ERASE SELECTED						*/

DCL (XPOS)	FIXED PUBLIC;	/*	TRANSPOSE BUTTON MODE:																					*/
									/*		0: OFF:		 TRANSPOSE OFF																			*/
									/*		1: ON:		 TRANSPOSE ON - WILL TURN OFF AUTOMATICALLY WHEN KEY IS PRESSED		*/
									/*		2: BLINKING: TRANSPOSE LOCKED ON - WILL STAY ON UNTIL TRANSPOSE BUTTON PRESSED	*/
#if (true)
DCL CLICK.TRACK.MODE	FIXED PUBLIC;	/*	CLICK TRACK MODE:	(NEW)	*/	/*	CLICK TRACK MODE:	(OLD)	*/
												/*		 0: INTERNAL CLICK	*/	/*		 0: B.P.M.				*/
												/*		 1: UNUSED				*/	/*		 1: MILLISECONDS		*/
												/*		 2: UNUSED				*/	/*		 2: UNUSED				*/
												/*		 3: EXTERNAL CLICK	*/	/*		 3: EXTERNAL CLICK	*/
												/*	4-203: LOCKED TO TRACK	*/	/*	4-203: LOCKED TO TRACK	*/
#else
DCL CLICK.SOURCE	FIXED PUBLIC;		//	CLICK.SOURCE:	(PLANNED)
												//			0 = INTERNAL CLICK
												//			1 = EXTERNAL CLICK
												//			2 = LOCKED TO TRACK

DCL CLICK.TRACK	FIXED PUBLIC;		//	CLICK.TRACK:	(PLANNED)
												//			0 through 255: absolute track number when locked to track
#endif

//	CLICK.DISP.MODE represents whether the click is displayed as beats per minute, milliseconds per beat
// or frames-per-beat.
//	This information used to be contained in the variable CLICK.TRACK.MODE.  This prevented the display mode
//	from being remembered when returning to internal click from an external click or from a click track.
//	To correct this shortcoming and also to allow the click display mode to be a user default, CLICK.DISP.MODE
//	will now hold this value instead.
//
DCL CLICK.DISP.MODE	FIXED PUBLIC;	/*	CLICK DISPLAY MODE:				*/
												/*		0: B.P.M.						*/
												/*		1: MILLISECONDS				*/
												/*		2: FILM FRAMES PER BEAT		*/
												/*		3: SMPTE FRAMES PER BEAT	*/

//	CLICKON represents whether the click is to be audible or not.  This information used to be contained in
//	the variable CLICK.TRACK.MODE.  Since it was encoded in one fashion for internal clicks, in a different
//	fashion for click tracks and not at all for external click, an awful lot of conditional and bit manipulation
//	code was required in the multitude of places where this variable was accessed.  Consequently, CLICKON will
//	now hold this value instead, both to reduce processor load, but also to vastly simplify letting the user
//	access the on/off status and the modes as independent parameters.
//
DCL CLICKON						 BOOLEAN PUBLIC;

DCL (CONTINUE.BUTTON.ACTIVE)	FIXED PUBLIC;	/*	TRUE IF LOOKING FOR FIRST NOTE	*/

DCL (NEW.MOTION)					FIXED PUBLIC;	/*	SET IF NEW INFO FOR L.O.D	*/
DCL (LOD.PLAY.TRACKS)			FIXED PUBLIC;	/*	LOD TRACKS TO PLAY			*/
DCL (LOD.RECD.TRACKS)			FIXED PUBLIC;	/*	LOD TRACKS TO RECORD ON		*/
DCL (NEW.CUE.TRACK.SETTINGS)	FIXED PUBLIC;	/*	NEW CONSTANTS FOR CUE TRACKS	*/

DCL (SAMP.SPEED)					FIXED PUBLIC;
DCL (SAMP.CLICK.RATE)			FIXED PUBLIC;
DCL (SAMP.CRM)						FIXED PUBLIC;
DCL (SAMP.BPM)						FIXED PUBLIC;

DCL (SM.HRS,SM.MIN,SM.SEC)		FIXED PUBLIC;	/*	NOTE: DECLARE HOURS, MINUTES			*/
DCL (SM.FRA,SM.BIT,SM.MODE)	FIXED PUBLIC;	/*	SECONDS, FRAMES, AND BITS IN ORDER	*/

/*	KEEP NEXT TWO IN ORDER	*/
DCL MARK.BUTTON.MSB				FIXED PUBLIC;	/*	MARK START POINT IN SEQUENCER	*/
DCL MARK.BUTTON.LSB				FIXED PUBLIC;	/*	TIME UNITS							*/

DCL CHECK.SEQUENCER.TIMES		FIXED PUBLIC;	/*	SET IF WE NEED TO CHECK VARS BELOW	*/
DCL AUTO.PUNCH.IN.ARMED			FIXED PUBLIC;	/*	RECORD PRESSED, READY TO PUNCH IN	*/
DCL PLAY.SEQ.TO.A.TIME			FIXED PUBLIC;	/*	SEQUENCER WILL "PLAY TO" A TIME, THEN STOP	*/
DCL EXT.REC.TRIGGER.STATE		FIXED PUBLIC;	/*	STATE OF EXTERNAL RECORD TRIGGERS	*/

DCL AUTO.PUNCH.ON					FIXED PUBLIC;	/*	AUTO PUNCH MODE ON IF NON-ZERO		*/
DCL REHEARSE.MODE					FIXED PUBLIC;	/*	TRUE IF AUTO PUNCH IN IS ACTUALLY A REHEARSE	*/
DCL PRE.ROLL.MSB					FIXED PUBLIC;	/*	SNAPSHOT START TIME FOR AUTO PUNCH	*/
DCL PRE.ROLL.LSB					FIXED PUBLIC;
DCL AUTO.PUNCH.IN.MSB			FIXED PUBLIC;	/*	SNAPSHOT PUNCH IN TIME	*/
DCL AUTO.PUNCH.IN.LSB			FIXED PUBLIC;
DCL AUTO.PUNCH.OUT.MSB			FIXED PUBLIC;	/*	SNAPSHOT PUNCH OUT TIME	*/
DCL AUTO.PUNCH.OUT.LSB			FIXED PUBLIC;

DCL SEQ.PLAY.TO.MSB				FIXED PUBLIC;	/*	SEQUENCER PLAY TO TIME	*/
DCL SEQ.PLAY.TO.LSB				FIXED PUBLIC;

/*	EXTERNAL RECORD TRIGGER TIMES	*/

DCL PREROLL_TRIGGER(1)			FIXED PUBLIC;	/*	TIME TO TRIGGER PREROLL		*/
DCL REC_IN_TRIGGER(1)			FIXED PUBLIC;	/*	TIME TO TRIGGER RECORD IN	*/
DCL REC_OUT_TRIGGER(1)			FIXED PUBLIC;	/*	TIME TO TRIGGER RECORD OUT	*/

/*	VARIABLES THAT ALLOW CUSTOM CONSOLE CONTROLLER (CCC) AND EXTERNAL
	TRIGGERS TO SHARE THE D34 LATCHES ON THE D34GPI	*/

DCL D34_CCC_BITS					FIXED PUBLIC;	/*	D34 BITS LIT BY CCC (ON D34GPI)		*/
DCL D34_TRIGGER_BITS				FIXED PUBLIC;	/*	D34 BITS LIT BY EXTERNAL TRIGGERS	*/

DCL (OVERALL.LOOP)				FIXED PUBLIC;	/*	REAL TIME OF OVERALL	*/
DCL (GOBACK.PLAY.TIME.MSB)		FIXED PUBLIC;	/*	LOOP.						*/
DCL (GOBACK.PLAY.TIME.LSB)		FIXED PUBLIC;

DCL (GOBACK.SEQ.TIME.MSB)		FIXED PUBLIC;	/*	VERSION THAT HAS BEEN	*/
DCL (GOBACK.SEQ.TIME.LSB)		FIXED PUBLIC;	/*	MAPPED TO SEQ TIMES	*/

DCL PHASE.INFO						FIXED PUBLIC;	/*	SET TRUE IF PHASE INFO IN FIRST COEFF WORD	*/
DCL (C.FRAME,FR.PTRS) (NUM.PARTIALS-1)	FIXED PUBLIC;
DCL PAR.TOP							FIXED PUBLIC;	/*	LENGTH (WORDS) OF TIMBRE AREA	*/
DCL PAR.NUMT						FIXED PUBLIC;	/*	NUMBER OF TIMBRES IN PAR.PTR	*/
DCL ACTIVE.BANK.LEN				FIXED PUBLIC;	/*	LENGTH OF BANK AREA				*/
DCL MISSING.TIM.HEAD				FIXED PUBLIC;
DCL (SELECTED.PARTIALS)			FIXED PUBLIC;	/*	BITS FOR SELECTED PARTIALS	*/

/*	VARIABLES FOR EXTERNAL SYNC:	*/

DCL (EXT.CLOCK.MODE)		FIXED PUBLIC;	/*	MODE OF EXTERNAL CLOCK:			*/
													/*		0: INTERNAL SYNC				*/
													/*		1: 50 HZ SYNC					*/
													/*		2: EXT BEAT SYNC				*/
													/*		3: MIDI INPUT					*/
													/*		4: MIDI AUX INPUT				*/
													/*		5: MIDINET						*/
													/*    6: OMS Midi Sync				*/
DCL (CLOCK.DATA)			FIXED PUBLIC;	/*	USED TO DETECT CHANGES IN EXT CLOCK INPUT	*/
DCL (EXT.CLOCK.CASE)		FIXED PUBLIC;	/*	FOR INTERRUPT ROUTINE							*/
DCL (TRIGGER.CLICK)		FIXED PUBLIC;	/*	USED WITH EXTERNAL AND LIVE CLICK TRACKS	*/
DCL (LOOP.TRIG.CLICK)	FIXED PUBLIC;	/*	LOOPING VERSION									*/
DCL (CREATE.50HZ.CLOCK)	FIXED PUBLIC;	/*	TRUE TO CREATE 50 HERTZ CLOCK OUTPUT		*/
DCL (EXT.CLOCK.TOGGLE)	FIXED PUBLIC;	/*	TOGGLE FOR EXTERNAL 50 HERTZ SIGNAL			*/
DCL (CREATE.BEAT.CLOCK)	FIXED PUBLIC;	/*	TRUE TO CREATE BEAT SYNC CLOCK OUTPUT		*/
DCL (EXT.CLOCK.ACCUM)	FIXED PUBLIC;	/*	FOR EXT CLOCK AT BEAT RATE						*/
DCL (EXT.CLOCK.OUT)		FIXED PUBLIC;	/*	STATE OF EXTERNAL CLOCK OUTPUT				*/
DCL (EXT.SPEED.ACCUM)	FIXED PUBLIC;	/*	FOR EXTERNAL BEAT SYNC GENERATION			*/
DCL (EXT.BEAT.TRIGGER)	FIXED PUBLIC;	/*	FOR EXTERNAL BEAT SYNC GENERATION			*/
DCL (MIDI.LIMIT.MSB)		FIXED PUBLIC;	/*	LIMIT FOR MIDI CLOCK OUTPUT					*/
DCL (MIDI.LIMIT.LSB)		FIXED PUBLIC;
DCL (MIDI.LIMIT.REM)		FIXED PUBLIC;	/*	REMAINDER FOR MIDI CLOCK OUTPUT				*/

DCL REAL.TIME.OF.MIDI.LIMIT.MSB	FIXED PUBLIC;	/*	REAL TIME LIMIT OF MIDI CLOCK	*/
DCL REAL.TIME.OF.MIDI.LIMIT.LSB	FIXED PUBLIC;	/*	ALSO USED TO GATE MTC OUTPUT	*/
DCL REAL.TIME.OF.MIDI.LIMIT.ACU	FIXED PUBLIC;	/*	BYTES									*/

DCL ENABLE.KEY.TRIG		FIXED PUBLIC;	/*	VARIABLES FOR DRUM REPLACEMENT TRIGGER	*/
dcl key.is.triggered		fixed PUBLIC;
dcl key.trig.time			fixed PUBLIC;
dcl key.rel.time			fixed PUBLIC;
dcl key.end.time			fixed PUBLIC;

DCL EST.RATE				FIXED PUBLIC;	/*	FOR USE WITH PUBLIC CLICK TRACK			*/

DCL EXT.REP.ARP			FIXED PUBLIC;	/*	SET TO ALLOW PUBLIC REPEAT/ARPEGGIATE	*/
DCL NEW.EXT.PULSE			FIXED PUBLIC;	/*	SET WHEN EXT PULSE RECEIVED				*/
DCL EXT.PULSE.TIME		FIXED PUBLIC;	/*	TIME OF PUBLIC REPEAT PULSE				*/

DCL CLOCK.ADVANCES		FIXED PUBLIC;	/*	FOR EXTERNAL CLOCK INPUT					*/
DCL CLOCK.RECEIVED		FIXED PUBLIC;	/*	FOR EXTERNAL BEAT SYNC INPUT				*/
DCL NUM.RECEIVED.CLOCKS	FIXED PUBLIC;	/*	NUMBER OF CLOCKS RECEIVED IN INTERRUPT SINCE LAST MAIN LOOP	*/
DCL REAL.CLOCK.RATE		FIXED PUBLIC;	/*	CURRENT RATE OF EXTERNAL CLOCK IN REAL TIME DURATION	*/
DCL NEXT.CLOCK.RATE		FIXED PUBLIC;	/*	RATE OF EXTERNAL CLOCKS AT NEXT TEMPO CHANGE	*/
DCL CLOCK.LIMIT.MSB		FIXED PUBLIC;	/*	LIMIT FOR BEAT/MIDI SYNC INPUT			*/
DCL CLOCK.LIMIT.LSB		FIXED PUBLIC;
DCL CLOCK.LIMIT.REM		FIXED PUBLIC;	/*	REMAINDER FOR BEAT/MIDI SYNC INPUT		*/
DCL CLOCK.DELAY.TIME		FIXED PUBLIC;	/*	SYNC DELAY TIMER FOR BEAT SYNC			*/
DCL DISABLE.RECEIVED.CLOCKS		FIXED PUBLIC;	/*	FLAG TO PREVENT INTERRUPT CODE FROM INTERFERRING WITH MAIN LOOP CALCULATION	*/

DCL REAL.TIME.OF.CLOCK.LIMIT.MSB	FIXED PUBLIC;	/*	REAL TIME LIMIT OF EXTERNAL BEAT/MIDI CLOCKS	*/
DCL REAL.TIME.OF.CLOCK.LIMIT.LSB	FIXED PUBLIC;

DCL (SAMP.EXT.DIV)		FIXED PUBLIC;	/*	SAMPLED BEAT DIVISOR FOR EXT SYNCING	*/

/*	BITS FOR GUITAR PERFORMANCE PARAMETERS- STORED IN GTINFO.LOC (SEE ABOVE):		*/

dcl quant					fixed public;	/*	true for quantization	*/
dcl pfilt					fixed public;	/*	activate pitch filter	*/
dcl tfilt					fixed public;	/*	activate pitch transient filter	*/
dcl vtrack					fixed public;	/*	true for volume envelope tracking	*/
dcl dcont					fixed public;	/*	decay control - true suppresses dual decays	*/
dcl tfilten					fixed public;	/*	set to zero to remove trans filter completely	*/
dcl follow.guitar			fixed public;	/*	true when guitar envelope is to be followed	*/
