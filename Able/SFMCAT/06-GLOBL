/* 06-GLOBL  $TITLE  Global Definitions - File Control Blocks and Error Messages *//* Copyright 1985 by New England Digital Corporation */dcl starting.sector.msb    lit '0';dcl file.sector.length.msb lit '0';dcl heading.length   lit '1'; /* length of heading buffer in sectors */dcl symbol.sectors   lit '2'; /* number of sectors of symbols */dcl time.vector.len  lit '3'; /* length of sec, ms, usec time vector */dcl index.vector.len lit '3'; /* length of drive,sector,offset (index) vector *//* File Control Block definition *//* Because length of file may be > 65k works, and because more than   one file may be needed at one time (as in filtering) we use a different   location and format than the monitor's fcb in upper memory */dcl f.symbolptr   lit '(f.headptr+heading.length*sector.size)';  /* point to symbols buffer */dcl f.name        lit 'location(fcb.ptr)';  /* file name */dcl f.name.bytes  lit 'core(fcb.ptr)';      /* word 0 of file name */dcl f.index       lit '(fcb.ptr+05)';       /* pointer to 3 word drive, sector, offset index vector */dcl f.drive       lit 'core(f.index+00)';   /* device byte and upper 8 bits of 24 bit sector */  dcl f.sector      lit 'core(f.index+01)';   /* low 16 bits of starting sector */dcl f.offset      lit 'core(f.index+02)';   /* must be zero (3rd word of index.vector) */dcl f.tlength     lit '(fcb.ptr+8)';        /* pointer to 3 word vector, upper 8 bits of first word is upper 8 bits of 24 bit sectors */   dcl f.tlen.up     lit 'core(f.tlength+00)'; /* upper 8 bits of length in sectors */dcl f.tlen.low    lit 'core(f.tlength+01)'; /* lower 16 bits of 24 bit length */dcl f.tlen.offset lit 'core(f.tlength+02)'; /* offset, words */ dcl f.type        lit 'core(fcb.ptr+11)';   /* file type *//* heading data */dcl compatibility   lit 'core(f.headptr+000)'; dcl file.data.type  lit 'core(f.headptr+001)';dcl valid.data      lit '(f.headptr+002)'; /* point to 3 word index vector with number of data points in file */dcl total.data      lit '(f.headptr+006)'; /* point to total allocated data length */dcl data.end        lit '(f.headptr+009)'; /* time corresponding to valid.data-1  */dcl keyboard.decay.number lit 'core(f.headptr+012)';dcl semitones             lit 'core(f.headptr+013)'; /* pitch bend range in semitones  */dcl vibrato.rate          lit 'core(f.headptr+014)'; /* Hz*100 */dcl vibrato.depth         lit 'core(f.headptr+015)'; /* semitones*100 */dcl vibrato.attack        lit 'core(f.headptr+016)';  /* milliseconds */dcl vibrato.type          lit 'core(f.headptr+017)'; dcl hertz                 lit 'core(f.headptr+018)';dcl octave                lit '(f.headptr+019)'; /* floating point keyboard octave.cents set by user */dcl period.index          lit 'core(f.headptr+021)';    dcl nyquist.freq          lit 'core(f.headptr+022)'; /* in Hz */dcl mark.start            lit 'location(f.headptr+23)';    dcl mark.end              lit 'location(f.headptr+26)';    dcl cursor.time           lit 'location(f.headptr+29)';dcl gain.exponent         lit 'core(f.headptr+32)'; /* for filters, the scale factor */dcl number.of.symbols     lit 'core(f.headptr+33)'; /* number of symbols in sound file */dcl total.length          lit 'location(f.headptr+34)'; /* length of perfect looping file */dcl loop.length           lit 'location(f.headptr+37)'; /* length of perfect loop */dcl sfm.magic             lit 'core(f.headptr+40)'; /* used to detect possible changes in file */dcl stereo                lit 'core(f.headptr+41)'; /* used to detect stereo sound files (not allowed) */dcl sample.rate           lit 'core(f.headptr+42)'; /* used to detect sample rates above 50kHz */dcl sf.index.base         lit 'core(f.headptr+52)'; /* ptr to start of CATEGORY INDEX */dcl id.field.bytes        lit 'core(f.headptr+127)'; /* byte count of user string */dcl id.field              lit 'location(f.headptr+127)'; /* 128 byte string of user data */dcl sampled.data          lit '1';   /* file.data.type for raw sampled data */dcl extracted.data        lit '2';   /* extracted from another sound file */dcl filtered.data         lit '4';   /* filtered */dcl created.data          lit '8';   /* generated functions */dcl converted.data        lit '16';  /* sample rate converted */dcl modulated.data        lit '32';  /* modulated */dcl spliced.data          lit '64';  /* spliced */dcl mixed.data            lit '128'; /* mixed */dcl reversed.data         lit '256'; /* time reversed */dcl looped.data           lit '512'; /* looped perfectly */ dcl data.offset.vector    data (0,heading.length+symbol.sectors,0); /* to add to starting sector to get start of data */ dcl compute_f.data.index  lit  'call add_len_to_addr(data.offset.vector,location(f.index),location(f.data.index));';dcl compute_total.data    lit  'call sub_len_from_len(location(f.tlength),data.offset.vector,location(total.data));';dcl scale.factor          lit '5'; /*  volts full scale *//* $PAGE */dcl zero.vector   data (0,0,0);dcl zero.zero.one data (0,0,1);dcl zero.one.zero data (0,1,0);dcl log10    lit '0.4342946*log'; /* log (base 10) */dcl log2     lit '1.442696*log';  /* log (base 2) */dcl log.of.2 lit '0.6931475';  /* log(2); eg. exp(log.of.2*log2(x))=2^x */dcl fourforty floating data(440.0);/* declarations for all display types */dcl time.display      lit '1'; /* signal display */dcl spectral.display  lit '2'; /* spectrum plot */dcl real.time         lit '3'; /* envelope display */dcl cat.display       lit '4'; /* file catalog */dcl menu.display      lit '5'; /* command menu */dcl sym.display       lit '6'; /* symbol catalog */dcl set.menu          lit '7'; /* set menu */dcl non.graphical     lit '8'; /* file length display */dcl dir.display       lit '9'; /* sound file directory display */dcl nmax              lit '8192'; /* fft length in fast convolution program */dcl fft.max           lit '8192'; /* max spectral display fft length *//* variables which do not need to be preserved between overlays */dcl record.flag       fixed; /* status of current file */dcl display.type      fixed; /* current type of display on screen */dcl error.flag        fixed; /* error code storage */dcl any.kbd           fixed; /* set to 1 if system is configured for keyboard *//* $SUBTITLE  Error Message Code Table and Print Routine */dcl e.samp.per       lit '1'; /* illegal sample period */dcl e.samples        lit '2'; /* no samples to read */    dcl e.no.data        lit '3'; /* no data recorded */    dcl e.overrun        lit '4'; /* overrun condition */    dcl e.buf.size       lit '5'; /* memory buffer size too small */dcl e.saved          lit '6'; /* file name already on disk */dcl e.not.saved      lit '7'; /* file name not on disk */dcl e.no.room        lit '8'; /* no room on disk */dcl e.index          lit '9';dcl e.inval.name     lit '10';dcl e.table.full     lit '11';dcl e.location       lit '12';dcl e.dup.name       lit '13';dcl e.dup.loc        lit '14';dcl e.no.name        lit '15';dcl e.no.file        lit '16';dcl e.sys.error      lit '17';dcl e.file.type      lit '18';dcl e.overflow       lit '19';dcl e.not.exec       lit '20'; /* not executable file */dcl e.format         lit '21';dcl e.unrecog        lit '22';dcl e.window         lit '23';dcl e.recording      lit '24';dcl s.start          lit '25'; /* status OK */dcl e.max            lit '26'; /* max buffer overrun during sampling */dcl e.save           lit '27';dcl e.select         lit '28';dcl e.times          lit '29';dcl e.winch          lit '30';dcl s.finished       lit '31';dcl e.range          lit '32'; /* parameter out of allowed range */dcl e.not.catalog    lit '33';dcl e.must.save      lit '34';dcl e.window.length  lit '35'; /* window too long */dcl e.dup.file       lit '36'; dcl e.no.printer     lit '37';dcl s.average.ready  lit '39';dcl e.not.available  lit '40';dcl e.not.spec.file  lit '41';dcl e.fft.len        lit '42';dcl e.not.delete     lit '43';dcl e.zero           lit '44';dcl e.sfm.write      lit '45';dcl e.pgm.too.big    lit '46';dcl e.old.exec       lit '47';dcl e.invalid.device lit '48'; /* device is not configured into system */dcl e.cannot.play    lit '49'; /* trying to play off of a floppy disk */dcl e.invalid.mark   lit '50'; /* illegal time for MARK.START or MARK.END */dcl e.not.xpl        lit '51'; /* file is not an XPL program */dcl e.no.floppy      lit '52'; /* floppies not allowed in SFM */dcl e.validity       lit '53'; /* validity error in catalog */dcl e.inv.filename   lit '54'; /* invalid filename */dcl e.past.end       lit '55'; /* time value is out of range */dcl e.stereo         lit '56'; /* stereo sound files not allowed */dcl e.sample.rate    lit '57'; /* sample rate cannot be > 50kHz */dcl e.no.d66         lit '58'; /* no D66 configured in system *//* $PAGE */error:proc(code) swap; /* print error message according to value of code */   dcl code fixed;     do case code;      begin; /* OK status and other info */         dcl brk.str data('<BREAK> to return to Monitor');         ps ('OK'); call erase_line;         if (in.main.module<>0) and (any.kbd<>0) then do;            call pos(1,40); ps('Use <PF2> for Synclavier,');            call pos(2,40); ps('or '); ps(brk.str);         end;         else if any.kbd=0 then do; /* no clavier SFM system */            call pos(1,40); ps('Use '); ps(brk.str);         end;      end;      ps ('Sample period out of range');      ps ('Files must be at least one sector long');           ps ('No data was recorded');       ps ('SYSTEM ERROR:  Sample buffer overrun');      ps ('The memory buffer is too small');      ps ('Your file is already saved');      ps ('There is no file with that name');      ps ('No space available on disk');      ps ('Invalid index into symbol table');      ps ('Symbol name is not valid'); /* 10 */      ps ('No more room in symbol table');      ps ('Symbol location is beyond file limits');      ps ('Duplicate symbol name');      ps ('Duplicate symbol time');      ps ('Symbol not found'); /* 15 */      ps ('No display file');      ps ('System error or file missing ');      ps ('File type conflicts with operation');       ps ('Overflow');      ps ('Not an executable file'); /* 20 */      ps ('Format error in command');      ps ('Command unrecognized');      ps ('End of data is in window');      ps ('Recording already in progress');       ps ('Press RETURN to start recording'); /* OK status */      ps ('Plot error');      ps ('Cannot save');      ps ('Incorrect card or register');      ps ('Incorrect times');      ps ('Winchester I/O error'); /* 30 */      ps ('Recording finished');      ps ('Input value out of range');      ps ('Not a subcatalog name');      ps ('Your current file is not saved');      ps ('The impulse response or window is too long'); /* 35 */      ps ('Duplicate file name');      ps ('System not configured for printer');      ps ('File is not a patch');   /* no longer used */      ps ('Press RETURN for averaged spectrum');      ps ('Function not available'); /* 40 */      ps ('File is not a saved spectrum file');      ps ('Spectra have different lengths');      ps ('ORIGIN or END may not be deleted');      ps ('Cannot zero a file in use');      ps ('SFM just tried to overwrite the catalog!'); /* 45 */      ps ('Not enough memory for this software');      ps ('Software is incompatible with system');      ps ('Device is not configured into system');      ps ('Cannot PLAY or RECORD on floppy drives');      /*   4         5         6         7          */      /*   0123456789012345678901234567890123456789 */      ps ('Play markers must lie outside of loop'); /* 50 */      ps ('File is not an XPL program');      ps ('May not ENTER floppy drives with SFM');      ps ('Validity error in catalog');      ps ('Invalid filename');      ps ('Time value beyond file limits'); /* 55 */      ps ('Stereo sound files not allowed in SFM');      ps ('Sample rate too large for SFM');      ps ('Cannot PLAY file - no D66 configured'); /* 58 */   end; /* of do case */end error;