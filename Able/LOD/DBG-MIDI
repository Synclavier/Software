   /* dbg-midi = midi debug code */   if 0 then do;            /* code for midi in debugging */      if (subsystem.ready<>0) then begin;         dcl (midi)    fixed;         dcl (clk.cnt) fixed;         dcl (beat)    fixed;         dcl mode      fixed;         dcl (i,j,k)   fixed;         dcl m$song.pos lit '242';         dcl m$clock    lit '248';         dcl m$start    lit '250';         dcl m$continue lit '251';         dcl m$stop     lit '252';         if beat=0 then beat=1;         write("70")=16; /* select subsystem 0 */         write("71")=4;  /* enable for read of input port */         if read("71") then do;            midi=read("72");            if midi=m$start then do;               mode=1;               clk.cnt=0; beat=1;               if log.buf(0)=0 then do;                  call log.error('Start ');call append.decimal.number(beat);               end;            end;            else if midi=m$stop then do;               mode=0;               clk.cnt=0;               if log.buf(0)=0 then do;                  call log.error('Stop ');               end;            end;            else if midi=m$continue then do;               mode=1;               if log.buf(0)=0 then do;                  call log.error('Continue ');call append.decimal.number(beat);               end;            end;            else if midi=m$song.pos then do;               clk.cnt=0;               i=read("72")&127;               i=i\shl(read("72")&127,7);               beat=shr(i,2)+1;               if log.buf(0)=0 then do;                  call log.error('Song Ptr ');call append.decimal.number(beat);               end;            end;            else if midi=m$clock then do;               if mode<>0 then do;    /* playing */                  clk.cnt=clk.cnt+1;                  if clk.cnt=24 then do;                     beat=beat+1;                     clk.cnt=0;                     if (mode<>0) and (log.buf(0)=0) then do;                        call log.error('New Beat ');call append.decimal.number(beat);                     end;                  end;               end;            end;         end;      end;   end;