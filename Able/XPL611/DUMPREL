/* $title Dump Relocatable Files *//* This program dumps relocatable files by calling DUMPIF.   By:  Karim J. Chichakly on 16 July 1987*/insert ':-xpl:asciilit'; /* ascii literals */insert ':-xpl:catrtns'; /* need the catalog routines */insert ':-xpl:fileio'; /* use fileio to simulate READIF */dcl rfbuf(10) fixed;	// put here to get literals to translate correctlywhen break then call exit (0); /* let them get out *//* globals */dcl reloc file; /* relocatable file to dump */dcl (lib_name, name_lib, get_sym, ptr_sym) (0) fixed; /* for library and external defs (internal to pass 3) */dcl (keyloc, keyjto, keyflag, r)           (0) fixed; /* for DUMPKEYS */dcl (abit, dbit, pbit)                         fixed;   /* for DUMPKEYS */dcl (proc_entry, proc_jump, proc_return, proc_dswp, proc_regs, proc_noswap, proc_size, proc_flags, proc_stack, proc_temps) fixed; /* for DUMPKEYS *//* IF handling */dcl readif lit 'getw (reloc)'; /* read a word from the IF */dcl posif  lit 'seek (reloc, 0, 1)'; /* position of IF */resetif: proc(pos); /* reset IF to position POS */   dcl pos fixed; /* position to reset IF to */   call seek (reloc, pos, 0); /* seek away */end resetif;insert ':xpl611:defs'; /* global definitions */insert ':xpl611:p3-defs'; /* pass 3 definitions */insert ':xpl611:p23-defs'; /* pass 2 and 3 definitions */insert ':xpl611:dumpif2'; /* get DUMPIF *//* Main program */dcl name (64) fixed; /* name of relocatable file */dcl i         fixed;print 'Reloc file to dump? ',;linput name; name (0) = name (0) - 1; /* get name */reloc = fopen (name, 'r'); /* try to open it */if reloc <> nullf then do; /* if the file exists */   if f#type = t#reloc then do; /* if relocatable binary */      if not feof (reloc) then do; /* if non-empty file */         do i = 1 to readif; /* skip header */            call readif;         end; /* of skip header */         call dumpif; /* dump it */      end; /* of non-empty file */      else print 'File ', string (name), ' is empty.';   end; /* of relocatable binary */   else print 'File ', string (name), ' is not a relocatable binary.';end; /* of file exists */else print 'File ', string (name), ' not found.';